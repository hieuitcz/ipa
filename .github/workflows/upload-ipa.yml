name: Upload IPA to Release

on:
  workflow_dispatch:
    inputs:
      ipa_url:
        description: 'Direct URL to IPA file'
        required: true
        type: string
      release_tag:
        description: 'Release tag name'
        required: true
        default: 'v1.0.0'
        type: string

jobs:
  upload:
    runs-on: ubuntu-latest
    
    steps:
      - name: Download IPA from URL
        run: |
          curl -L "${{ github.event.inputs.ipa_url }}" -o app.ipa
      
      - name: Create Release and Upload IPA
        uses: svenstaro/upload-release-action@v2
        with:
          repo_token: ${{ secrets.GITHUB_TOKEN }}
          file: app.ipa
          asset_name: app-${{ github.event.inputs.release_tag }}.ipa
          tag: ${{ github.event.inputs.release_tag }}
          overwrite: true
          body: "IPA build uploaded"
